{
   "properties": {
      "displayName": "Audit unrestricted network access to Key Vault",
      "description": "Audits Key Vault vaults if Key Vault Firewall is not enabled",
      "mode": "Indexed",
      "parameters": {},
      "policyRule": {
		  "if": {
			"allOf": [
			  {
				"field": "type",
				"equals": "Microsoft.KeyVault/vaults"
			  }
			]
		  },
		  "then": {
			"effect": "auditIfNotExists",
			"details": {
			  "type": "Microsoft.KeyVault/vaults",
			  "existenceCondition": {
				"allOf": [
				  {
					"field": "Microsoft.KeyVault/vaults/networkAcls.defaultAction",
					"equals": "Deny"
				  }
				]
			  }
			}
		  }
      }
   }
}
